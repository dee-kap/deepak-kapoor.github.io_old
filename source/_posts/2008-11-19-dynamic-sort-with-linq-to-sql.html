---
layout: post
title: Dynamic Sort With LINQ To SQL
categories:
- .NET
- Microsoft
tags:
- LINQ
status: publish
type: post
published: true
meta:
  _wpas_done_all: '1'
  views: '17084'
  _edit_last: '1'
  _wp_rp_extracted_image_url: https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2013/04/image113-150x150.jpg
  _wp_rp_extracted_image_url_full: https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2013/04/image113.png
  simplecatch-sidebarlayout: ''
---
<blockquote></blockquote>  <p>Sometime ago I wrote a post showing how to do <a href="http://www.debugrelease.com/dynamic-sort-with-linq/">dynamic sort with LINQ</a>. That approach worked well with LINQ To Objects. Today I spotted a <a href="http://forums.asp.net/p/1349895/2753778.aspx">question on the forums</a> where Levi asked a question about doing dynamic sorts with LINQ To SQL. My earlier approach will work once all the data is retrieved on the client side. This of course is not an ideal way. A&#160; better option is to do sorting on database. Here is the question as it was posted on the forum.</p>  <p><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="525" alt="C# Visual Studio .Net Code" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/11/image11.png" width="522" border="0" /> </p>  <h4>I thought this will work</h4>  <p>My initial reaction was to modify the code I wrote earlier to dynamically create a query. This is what I did.</p>  <p><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="132" alt="C# Visual Studio .Net Code" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/11/image12.png" width="479" border="0" /></p>  <p>and I used this code to call my method</p>  <p><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="36" alt="C# Visual Studio .Net Code" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/11/image13.png" width="440" border="0" /> </p>  <p>LINQ To SQL is not able to generate a query and instead throws an exception when I try to access the results in debugger.</p>  <p><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="43" alt="C# Visual Studio .Net Code" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/11/image14.png" width="550" border="0" /> </p>  <h4>So what can be done?</h4>  <p>The key here is to generate the query dynamically. And we can&#160; use the built-in Expression type to do just that. So I gave it another go with this code.</p>  <p><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="325" alt="C# Visual Studio .Net Code" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/11/image15.png" width="523" border="0" /> </p>  <p>This method takes in a column name to sort by and returns&#160; IQueryable&lt;T&gt;. </p>  <p>It works but looks like a lot of effort and appears miles away from any kind of normal LINQ code. Fortunately I can achieve the same results with this code.</p>  <p>&#160;<img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="82" alt="C# Visual Studio .Net Code" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/11/image16.png" width="570" border="0" /> </p>  <p>To sort by Title, I can call the method like this.</p>  <p>&#160;<img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="20" alt="C# Visual Studio .Net Code" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/11/image17.png" width="391" border="0" /> </p>  <p>This gives me exactly what I want and partially answers the question posted on the forum. Partially, because I have not addressed dynamic grouping. I assume that it is doable with a similar approach.</p> <a href="http://www.dotnetkicks.com/kick/?url=http%3a%2f%2fwww.thereforesystems.com%2fdynamic-sort-with-linq-to-sql%2f"><img alt="kick it on DotNetKicks.com" src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http%3a%2f%2fwww.thereforesystems.com%2fdynamic-sort-with-linq-to-sql%2f" border="0" /></a>
