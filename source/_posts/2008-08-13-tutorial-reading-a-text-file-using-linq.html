---
layout: post
title: Tutorial Reading A Text File Using LINQ
categories:
- .NET
- Microsoft
tags:
- .Net
- C#
- LINQ
status: publish
type: post
comments: true
published: true
meta:
  _wpas_done_all: '1'
  views: '40789'
  _edit_last: '1'
  _wp_rp_extracted_image_url: https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2013/04/image234-150x150.jpg
  _wp_rp_extracted_image_url_full: https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2013/04/image234.png
  _featured_post: ''
  simplecatch-sidebarlayout: ''
---
<h4>Introduction</h4>
At times us developers have to deal with delimited text files in our applications. Such files have been around since yonks and I often come across data import/export tasks where delimited files are used. Till now the common way in .NET has been to read each line and then extract data using some sort of creative string functions within for loops. But there is another way by using LINQ. In this tutorial I will show you how to use LINQ to read such data. By the end of tutorial you will appreciate how easy and logical it is to use LINQ for reading data from delimited text files.
<h4>Sample Data</h4>
I will use a sample file which contains a data about customers. When working with text files we must know the number of columns and the data contained in each column. Below is a list of columns in their right order for our file.
<ol>
	<li>First Name</li>
	<li>Last Name</li>
	<li>Job Title</li>
	<li>City</li>
	<li>Country</li>
</ol>
The file itself will contain this data. I have pulled this out of Employees table in Northwind database.

<img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image23.png" border="0" alt="image" width="462" height="233" />
<h4>Reading Data</h4>
Before we start reading our csv file we will create a class which will hold a record we will read from our csv file. For this I will create a customer class which looks like this. I know I pulled data from Employees table so just imagine that data above is customer data. Employees can also be customers ;)

 
<pre class="lang:c# decode:true " >public class Customer
{
  string Firstname { get; set; }
  string Lastname { get; set; }
  string JobTitle { get; set; }
  string City { get; set; }
  string Country { get; set; }
}</pre> 


<h5>Reading Entire File</h5>
Now we are ready to read data from our file using LINQ. Using this code we can read the entire file. I am also using a foreach statement to output the results.

 
<pre class="lang:c# decode:true " >var query =
  from line in File.ReadAllLines(filePath)
  let customerRecord = line.Split(',')
  select new Customer()
  {
    Firstname = customerRecord[0],
    Lastname = customerRecord[1],
    JobTitle = customerRecord[2],
    City = customerRecord[3],
    Country = customerRecord[4]
  };

foreach (var item in query)
{
  Console.WriteLine("{0}, {1}, {2}, {3}, {4}",
    item.Firstname, item.Lastname, item.JobTitle, item.City, item.Country);
}</pre> 


File.ReadAllLines() returns an array of lines and we then use the split function of array to split it by a comma. Its just that simple.
<h5>Reading selected records</h5>
We can use this code to read all customers who live in UK.

 
<pre class="lang:c# decode:true " >var query =
  from c in
  (from line in File.ReadAllLines(filePath)
    let customerRecord = line.Split(',')
    select new Customer()
    {
      Firstname = customerRecord[0],
      Lastname = customerRecord[1],
      JobTitle = customerRecord[2],
      City = customerRecord[3],
      Country = customerRecord[4]
    })
    where c.Country == "UK"
    select c;</pre> 


This code can be used to read customers who have sales in their job title.

 
<pre class="lang:c# decode:true " >var query =
        from c in
            (from line in File.ReadAllLines(filePath)
             let customerRecord = line.Split(',')
             select new Customer()
                 {
                     Firstname = customerRecord[0],
                     Lastname = customerRecord[1],
                     JobTitle = customerRecord[2],
                     City = customerRecord[3],
                     Country = customerRecord[4]
                 })
        where c.JobTitle.Contains("Sales")
        select c;</pre> 


I am sure that above queries can be polished by using a bit more syntax sugar but I am just too excited to see LINQ working with a csv file.
<h4>Conclusion</h4>
LINQ makes it extremely simple to work with delimited text files. Once we have the records from a csv file in an object we can use all the power of LINQ to query our hearts out on such files. This functionality is available to us via LINQ to objects and we do not need another flavour of LINQ to achieve this. Stay tuned for more posts on LINQ.
