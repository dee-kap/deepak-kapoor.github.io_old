---
layout: post
title: Dynamic Sort With LINQ
categories:
- .NET
- Microsoft
tags:
- C#
- LINQ
status: publish
type: post
comments: true
published: true
meta:
  _wpas_done_all: '1'
  views: '54041'
  _edit_last: '1'
  _wp_rp_extracted_image_url: ''
  _wp_rp_extracted_image_url_full: ''
  simplecatch-sidebarlayout: ''
---
<p>In this post I will show you how to perform dynamic sorting with LINQ. I will work with a simple collection of City class. City class is defined below.</p>

<pre class="prettyprint">
public class City
{
  public string Name { get; set; }
  public string Country { get; set; }
}
</pre>

<p>The collection is initialised using this code</p>

<pre class="prettyprint">
List<City> cities = new List<City>
  {
    new City{ Name = "Sydney", Country = "Australia" },
    new City{ Name = "New York", Country = "USA" },
    new City{ Name = "Paris", Country = "France" },
    new City{ Name = "Milan", Country = "Spain" },
    new City{ Name = "Melbourne", Country = "Australia" },
    new City{ Name = "Auckland", Country = "New Zealand" },
    new City{ Name = "Tokyo", Country = "Japan" },
    new City{ Name = "New Delhi", Country = "India" },
    new City{ Name = "Hobart", Country = "Australia" }
  };
</pre>

<p>A typical example of applying a sort will be to write such a query.</p>

<pre class="prettyprint">
var collection =
  from c in cities
  orderby c.Country
  select c;
</pre>

<p>Here we are sorting the collection on country. Note that this is static in nature.</p>

<p>Code above as you can see can only sort by country. If I wanted to sort by city name then I'd be writing another query and maybe use a conditional construct such as if or switch and write a method which takes in a parameter. While this will work, it is not the best way to do it.</p>

<p>LINQ gives us the ability to make our code dynamic. I can provide sort functionality for my query by writing a method which takes in a Func&lt;TElement, TKey&gt; delegate. This delegate is used by the OrderBy extension method. This is how I can write my method.</p>

<pre class="prettyprint">
public static void Sort<TKey>(List<City> cities, Func<City, TKey> selector)
{
  var sortedCollection =
    from c in cities
    orderby selector(c)
    select c;

  foreach (var item in sortedCollection)
  {
    Console.WriteLine(item.Name);
  }
}
</pre>

<p>This method can be called like this by passing in the cities collection which has been initialised earlier.</p>

<pre class="prettyprint">
Sort(cities, c => c.Name);
</pre>

<p>I can also sort by country without changing my query. To sort by country I just need to call my sort method like this.</p>

<pre class="prettyprint">
Sort(cities, c => c.Country);
</pre>

<p>LINQ is very powerful when you start using it on daily bases. It would not be very useful if everything was static. In this post I showed you how you can make your sorting code dynamic. Stay tuned for more LINQ goodness.</p>
