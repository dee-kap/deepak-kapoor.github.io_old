
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Deepak Kapoor</title>
  <meta name="author" content="Deepak Kapoor">

  
  <meta name="description" content="Event Log is a central place to log application events. These events can be errors, warnings or just information. Each event log entry in Windows &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.deepakkapoor.net/blog/page/33">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/deepakkapoor" rel="alternate" title="Deepak Kapoor" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
<link href="/stylesheets/debrel.css" rel="stylesheet" type="text/css">
<meta name="google-site-verification" content="lgYJWL_s1AZLFOqJ9ejrQhbIkJcvzpsBZnUBGHcNk-w" />

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Deepak Kapoor</a></h1>
  
    <h2>Programming and personal notes of Deepak Kapoor</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/deepakkapoor" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.deepakkapoor.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <!--<li><a href="/books">Books</a></li>-->
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/07/write-to-vista-event-log-using-c/">Write to Vista Event Log Using C#</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-07T00:00:00+10:00" pubdate data-updated="true">Aug 7<span>th</span>, 2008</time>
        
         | <a href="/2008/08/07/write-to-vista-event-log-using-c/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content">Event Log is a central place to log application events. These events can be errors, warnings or just information. Each event log entry in Windows Vista has a level of event, date and time the event occurred, source of event, an event Id and a task category. While event logs such as Application, System, Security exist by default, you can also create your own event log.

<img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image11.png" border="0" alt="image" width="560" height="342" />

You can also write to event log from your own  application using <strong>System.Diagnostics.EventLog</strong> class. The best practice is to check if the source exists. If it does not then you should create it before you write to it.
<div>
<div style="border-style: none; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;"><span style="color: #0000ff;">string</span> source = <span style="color: #006080;">"EventLog Demo"</span>;</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;"><span style="color: #0000ff;">if</span> (!EventLog.Exists(source))</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">    EventLog.CreateEventSource(source, <span style="color: #006080;">"Application"</span>);</pre>
</div>
</div>
We can now safely write to event log with a statement like this.
<div>
<div style="border-style: none; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">EventLog.WriteEntry(source, <span style="color: #006080;">"Writing Error"</span>, EventLogEntryType.Error, 7);</pre>
</div>
</div>
In the above statement I am writing an event of type error. There are five EventLogEntryType values available. Event viewer will show the appropriate icon depending on the entry type.

<img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image12.png" border="0" alt="image" width="127" height="99" />

After executing the code we can verify that my event entry is viewable in Event Viewer.

<img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image13.png" border="0" alt="image" width="538" height="71" />

Writing application events into Event Log should be a standard message/error logging practice for any application. Windows provides this standard location where it records its own events and this is where you look first when troubleshooting. Thus it makes perfect sense to use this for your own custom applications.
<div id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:0a7437bc-ec4f-4933-aaaf-272b0892474f" class="wlWriterSmartContent" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a rel="tag" href="http://technorati.com/tags/.Net">.Net</a>,<a rel="tag" href="http://technorati.com/tags/C#">C#</a>,<a rel="tag" href="http://technorati.com/tags/Vista">Vista</a></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/07/stylecop-tutorial/">StyleCop Tutorial</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-07T00:00:00+10:00" pubdate data-updated="true">Aug 7<span>th</span>, 2008</time>
        
         | <a href="/2008/08/07/stylecop-tutorial/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><a href="http://code.msdn.microsoft.com/sourceanalysis"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image5.png" border="0" alt="StyleCop" width="388" height="70" /></a>

<a href="http://code.msdn.microsoft.com/sourceanalysis">StyleCop</a> is a source analysis tool for C#. It can be used for analysing source code as opposed to compiled assemblies which is the area for FxCop. StyleCop is currently in version 4.2 and can be downloaded <a href="http://code.msdn.microsoft.com/sourceanalysis">here</a>. In this tutorial I will show you how to use StyleCop.

I will create a simple console application and use StyleCop to analyse the source.  This killer app just initialises a class and prints out few properties. Below is the code for the application.

 
<pre class="lang:c# decode:true " >public class Customer
{
	public string FirstName { get; set; }
	public string LastName { get; set; }
	public string Address { get; set; }
	public CustomerStatus Status { get; set; }
	public override string ToString()
	{
		string result = string.Format
			("First Name = {0}nLast Name = {1}nAddress = {2}nStatus = {3}"
			, FirstName, LastName, Address, Status);
		return result;
	}
}

public enum CustomerStatus
{
	Active,
	InActive
}

class Program
{
	static void Main(string[] args)
	{
		Customer customer = new Customer
		{
			FirstName = "John",
			LastName = "Smith",
			Address = "1 George Street, Sydney",
			Status = CustomerStatus.Active
		};
		Console.WriteLine(customer.ToString());
		Console.ReadKey();
	}
}</pre> 


I can run source code analysis on the entire project via Tools menu or an individual file by right clicking on the class file.

<img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image6.png" border="0" alt="image" width="291" height="268" />

By running source analysis on Program.cs I get 34 violations.

<img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image7.png" border="0" alt="image" width="491" height="361" />

Depending on your style or your coding standards, you will either agree or disagree with detected violations. For example in the result above I do not agree with rule SA1200 &#8220;All using directives must be placed inside of the namespace&#8221;. I have never declared my using statements inside the namespace and I do not intend to do so in future. So what can I do? I can easily modify the rule set. Let&#8217;s see how we can do this.

By default StyleCop is installed at C:Program FilesMicrosoft Source Analysis Tool for C#. A quick glance over the contents of this folder look like this.

<img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image8.png" border="0" alt="image" width="500" height="122" />

Notice the second last file which is Settings.SourceAnalysis. Double clicking it opens up the SourceAnalysisSettingsEditor where I can select/deselect the rules.

<img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image9.png" border="0" alt="image" width="520" height="474" />

I can turn off rule SA1200 &#8220;All using directives must be placed inside of the namespace&#8221; and then if I run analysis again, my result set will not show it as a rule violation.

<img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image10.png" border="0" alt="image" width="520" height="474" />

As you can see from screenshots above that rules are categorised into different categories such as Documentation Rules, Layout Rules, Naming Rules etc. This makes is easy work with rules in a logical way.
<h4>Conclusion</h4>
StyleCop is a light weight source code analysis tool which fills in the necessary gap. One of the benefits of StyleCop can be realised while conducting code reviews. Lately StyleCop has had its own share of controversy, but it is good that Microsoft is paying attention to this nifty tool which could attract a significant user base. StyleCop can be downloaded <a href="http://code.msdn.microsoft.com/sourceanalysis">here</a>.

<a href="http://www.dotnetkicks.com/kick/?url=http%3a%2f%2fwww.thereforesystems.com%2fstylecop-tutorial%2f"><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http%3a%2f%2fwww.thereforesystems.com%2fstylecop-tutorial%2f" border="0" alt="kick it on DotNetKicks.com" /></a>
<div id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:92323063-b680-419c-8e6a-72ce622ea3bf" class="wlWriterSmartContent" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a rel="tag" href="http://technorati.com/tags/C#">C#</a>,<a rel="tag" href="http://technorati.com/tags/StyleCop">StyleCop</a></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/06/free-icons-and-images-with-visual-studio-2008/">Free Icons and Images With Visual Studio 2008</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-06T00:00:00+10:00" pubdate data-updated="true">Aug 6<span>th</span>, 2008</time>
        
         | <a href="/2008/08/06/free-icons-and-images-with-visual-studio-2008/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><img style="border-top-width: 0px; border-left-width: 0px; float: left; border-bottom-width: 0px; border-right-width: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image2.png" border="0" alt="image" width="40" height="32" /> Visual Studio 2008 comes with an Image Library which contains thousands of icons, animations and images which you can use in your applications. You can find the Image Library at C:Program FilesMicrosoft Visual Studio 9.0Common7VS2008ImageLibrary1033

Just unzip VS2008ImageLibrary.zip file located at this location and you have most of the graphics used by Microsoft in many applications including Visual Studio itself.

<img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image3.png" border="0" alt="VS2008ImageLibrary" width="150" height="102" />
<div id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:b8c5c7e4-97cf-4d1e-a84b-7f5cacce310b" class="wlWriterSmartContent" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a rel="tag" href="http://technorati.com/tags/Visual%20Studio">Visual Studio</a></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/04/dynamic-sort-with-linq/">Dynamic Sort With LINQ</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-04T00:00:00+10:00" pubdate data-updated="true">Aug 4<span>th</span>, 2008</time>
        
         | <a href="/2008/08/04/dynamic-sort-with-linq/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content">In this post I will show you how to perform dynamic sorting with LINQ. I will work with a simple collection of City class. City class is defined below.

<code lang="csharp">
public class City
{
  public string Name { get; set; }
  public string Country { get; set; }
}
</code>

The collection is initialised using this code

<code lang="csharp">
List<City> cities = new List<City>
  {
    new City{ Name = "Sydney", Country = "Australia" },
    new City{ Name = "New York", Country = "USA" },
    new City{ Name = "Paris", Country = "France" },
    new City{ Name = "Milan", Country = "Spain" },
    new City{ Name = "Melbourne", Country = "Australia" },
    new City{ Name = "Auckland", Country = "New Zealand" },
    new City{ Name = "Tokyo", Country = "Japan" },
    new City{ Name = "New Delhi", Country = "India" },
    new City{ Name = "Hobart", Country = "Australia" }
  };
</code>

A typical example of applying a sort will be to write such a query.

<code lang="csharp">
var collection =
  from c in cities
  orderby c.Country
  select c;
</code>
Here we are sorting the collection on country. Note that this is static in nature.

Code above as you can see can only sort by country. If I wanted to sort by city name then I&#8217;d be writing another query and maybe use a conditional construct such as if or switch and write a method which takes in a parameter. While this will work, it is not the best way to do it.

LINQ gives us the ability to make our code dynamic. I can provide sort functionality for my query by writing a method which takes in a Func&lt;TElement, TKey&gt; delegate. This delegate is used by the OrderBy extension method. This is how I can write my method.

<code lang="csharp">
public static void Sort<TKey>(List<City> cities, Func<City, TKey> selector)
{
  var sortedCollection =
    from c in cities
    orderby selector(c)
    select c;

  foreach (var item in sortedCollection)
  {
    Console.WriteLine(item.Name);
  }
}
</code>

This method can be called like this by passing in the cities collection which has been initialised earlier.

<code lang="csharp">
Sort(cities, c => c.Name);
</code>

I can also sort by country without changing my query. To sort by country I just need to call my sort method like this.

<code lang="csharp">
Sort(cities, c => c.Country);
</code>

LINQ is very powerful when you start using it on daily bases. It would not be very useful if everything was static. In this post I showed you how you can make your sorting code dynamic. Stay tuned for more LINQ goodness.
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/01/different-ways-of-retrieving-data-from-collections/">Different Ways of Retrieving Data From Collections</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-01T00:00:00+10:00" pubdate data-updated="true">Aug 1<span>st</span>, 2008</time>
        
         | <a href="/2008/08/01/different-ways-of-retrieving-data-from-collections/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content">C# as a language has matured over years. We have come a long way from the first version of C# to the current which incorporates LINQ. Here is an example I recently used in a training session. My objective was to show students how we can retrieve items from a collection based on a certain criteria in different ways. The collection in question here is a collection of cities. City class looks like this:
<div class="csharpcode">
<pre class="alt"><span class="kwrd">public</span> <span class="kwrd">class</span> City</pre>
<pre>    {</pre>
<pre class="alt">        <span class="kwrd">public</span> <span class="kwrd">string</span> Name { get; set; }</pre>
<pre>        <span class="kwrd">public</span> <span class="kwrd">string</span> Country { get; set; }</pre>
<pre class="alt">    }</pre>
</div>
<!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->

Cities collection is initialised using this code:
<div class="csharpcode">
<pre class="alt">List&lt;City&gt; cities =</pre>
<pre>                <span class="kwrd">new</span> List&lt;City&gt;</pre>
<pre class="alt">                {</pre>
<pre>                    <span class="kwrd">new</span> City{ Name = <span class="str">"Sydney"</span>, Country = <span class="str">"Australia"</span> },</pre>
<pre class="alt">                    <span class="kwrd">new</span> City{ Name = <span class="str">"New York"</span>, Country = <span class="str">"USA"</span> },</pre>
<pre>                    <span class="kwrd">new</span> City{ Name = <span class="str">"Paris"</span>, Country = <span class="str">"France"</span> },</pre>
<pre class="alt">                    <span class="kwrd">new</span> City{ Name = <span class="str">"Milan"</span>, Country = <span class="str">"Spain"</span> },</pre>
<pre>                    <span class="kwrd">new</span> City{ Name = <span class="str">"Melbourne"</span>, Country = <span class="str">"Australia"</span> },</pre>
<pre class="alt">                    <span class="kwrd">new</span> City{ Name = <span class="str">"Auckland"</span>, Country = <span class="str">"New Zealand"</span> },</pre>
<pre>                    <span class="kwrd">new</span> City{ Name = <span class="str">"Tokyo"</span>, Country = <span class="str">"Japan"</span> },</pre>
<pre class="alt">                    <span class="kwrd">new</span> City{ Name = <span class="str">"New Delhi"</span>, Country = <span class="str">"India"</span> },</pre>
<pre>                    <span class="kwrd">new</span> City{ Name = <span class="str">"Hobart"</span>, Country = <span class="str">"Australia"</span> }</pre>
<pre class="alt">                };</pre>
</div>
<!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->

The objective is to find all cities in Australia and write their name to console. Here are the different ways it can be done.

Old Fashioned
<div class="csharpcode">
<pre class="alt"><span class="kwrd">foreach</span> (City item <span class="kwrd">in</span> cities)</pre>
<pre>{</pre>
<pre class="alt">  <span class="kwrd">if</span> (item.Country == <span class="str">"Australia"</span>)</pre>
<pre>    Console.WriteLine(item.Name);</pre>
<pre class="alt">}</pre>
</div>
<!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->

Using FindAll extension method
<div class="csharpcode">
<pre class="alt"><span class="kwrd">foreach</span> (City item <span class="kwrd">in</span> cities.FindAll(IsAustralianCity))</pre>
<pre>{</pre>
<pre class="alt">  Console.WriteLine(item.Name);</pre>
<pre>}</pre>
<pre class="alt"></pre>
<pre><span class="kwrd">private</span> <span class="kwrd">static</span> <span class="kwrd">bool</span> IsAustralianCity(City c)</pre>
<pre class="alt">{</pre>
<pre>  <span class="kwrd">if</span> (c.Country == <span class="str">"Australia"</span>)</pre>
<pre class="alt">    <span class="kwrd">return</span> <span class="kwrd">true</span>;</pre>
<pre>  <span class="kwrd">else</span></pre>
<pre class="alt">    <span class="kwrd">return</span> <span class="kwrd">false</span>;</pre>
<pre>}</pre>
</div>
<!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->

using FindAll with anonymous method
<div class="csharpcode">
<pre class="alt"><span class="kwrd">foreach</span> (City item <span class="kwrd">in</span> cities.FindAll(</pre>
<pre>  <span class="kwrd">delegate</span>(City c)</pre>
<pre class="alt">  {</pre>
<pre>    <span class="kwrd">return</span> c.Country == <span class="str">"Australia"</span>;</pre>
<pre class="alt">  }))</pre>
<pre>{</pre>
<pre class="alt">Console.WriteLine(item.Name);</pre>
<pre>}</pre>
</div>
<!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->

Using a LINQ query
<div class="csharpcode">
<pre class="alt">var collection =</pre>
<pre>  from c <span class="kwrd">in</span> cities</pre>
<pre class="alt">  <span class="kwrd">where</span> c.Country == <span class="str">"Australia"</span></pre>
<pre>  select c;</pre>
<pre class="alt"></pre>
<pre><span class="kwrd">foreach</span> (City item <span class="kwrd">in</span> collection)</pre>
<pre class="alt">{</pre>
<pre>  Console.WriteLine(item.Name);</pre>
<pre class="alt">}</pre>
</div>
<!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->

One liner using Lambda. My absolute favourite.
<div class="csharpcode">
<pre class="alt">cities.FindAll(c =&gt; c.Country == <span class="str">"Australia"</span>)</pre>
<pre>  .ForEach(c =&gt; Console.WriteLine(c.Name));</pre>
</div>
<!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->

Quite interesting to see how the language has evolved over time. I guess this is the kind of stuff which keeps us developers going. Good on you Microsoft! Keep it coming.

<a href="http://www.dotnetkicks.com/kick/?url=http%3a%2f%2fwww.thereforesystems.com%2fdifferent-ways-of-retrieving-data-from-collections%2f"><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http%3a%2f%2fwww.thereforesystems.com%2fdifferent-ways-of-retrieving-data-from-collections%2f" border="0" alt="kick it on DotNetKicks.com" /></a>
<div id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:702526be-e7a7-48ad-afd0-1604d867aa9b" class="wlWriterSmartContent" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a rel="tag" href="http://technorati.com/tags/C#">C#</a>,<a rel="tag" href="http://technorati.com/tags/LINQ">LINQ</a></div>
<!--.csharpcode, .csharpcode pre { 	font-size: small; 	color: black; 	font-family: consolas, "Courier New", courier, monospace; 	background-color: #ffffff; 	/*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt  { 	background-color: #f4f4f4; 	width: 100%; 	margin: 0em; } .csharpcode .lnum { color: #606060; } -->
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/34/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/32/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/11/27/octopress-setup-existing-blog-on-another-machine/">Octopress-Setup Existing Blog on Another Machine</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/31/linux-set-wireless-bit-rate-permanently-on-ubuntu-or-linux-mint/">Linux - Set Wireless Bit Rate Permanently on Ubuntu or Linux Mint</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/31/android-expandablelistview-tutorial/">Android - ExpandableListView Tutorial</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/28/linux-install-handbrake-on-linux-mint-15/">Linux - Install Handbrake on Linux Mint 15</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/26/linux-virtualbox-windows-host-share-in-ubuntu-guest/">Linux VirtualBox - Windows Host Share in Ubuntu Guest</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/25/linux-setgid-on-directory-and-share-directory-with-users/">Linux - Setgid on Directory and Share Directory With Users</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/03/linux-number-of-files-in-directory/">Linux - Number of Files in Directory</a>
      </li>
    
      <li class="post">
        <a href="/2013/06/24/android-listview-tutorial-with-images-and-text/">Android - ListView Tutorial With Images and Text</a>
      </li>
    
      <li class="post">
        <a href="/2013/06/19/android-listview-tutorial/">Android - ListView Tutorial</a>
      </li>
    
      <li class="post">
        <a href="/2013/06/11/android-linear-layout-example/">Android - Linear Layout Example</a>
      </li>
    
  </ul>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Deepak Kapoor -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=8878331; 
var sc_invisible=0; 
var sc_security="f0e88835"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="free hit
counters" href="http://statcounter.com/free-hit-counter/"
target="_blank"><img class="statcounter"
src="http://c.statcounter.com/8878331/0/f0e88835/0/"
alt="free hit counters"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://plus.google.com/105555323627924521684?rel=author">Google Profile</a>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-975050-1', 'deepakkapoor.net');
  ga('send', 'pageview');

</script>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'debugrelease';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
