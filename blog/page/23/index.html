
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Debug Release</title>
  <meta name="author" content="Deepak Kapoor">

  
  <meta name="description" content="Two senior engineering managers for Windows 7, Jon DeVaan and Steven Sinofsky have started a blog called Engineering Windows 7. I am sure that this &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://deepak-kapoor.github.io/blog/page/23">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Debug Release" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
<link href="/stylesheets/debrel.css" rel="stylesheet" type="text/css">
<meta name="google-site-verification" content="lgYJWL_s1AZLFOqJ9ejrQhbIkJcvzpsBZnUBGHcNk-w" />

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Debug Release</a></h1>
  
    <h2>Hacking notes of Deepak Kapoor</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/debug-release" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:deepak-kapoor.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/16/windows-7-conversation-begins/">Windows 7 Conversation Begins</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-16T00:00:00+10:00" pubdate data-updated="true">Aug 16<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content">Two senior engineering managers for Windows 7, Jon DeVaan and Steven Sinofsky have started a blog called <a href="http://blogs.msdn.com/e7/archive/2008/08/14/welcome.aspx">Engineering Windows 7</a>. I am sure that this will be one of the most watched blogs till other Windows 7 related blogs/sites appear. Reading their first post I get an impression that their blog is an attempt to engage community/customers in a conversation around next version of Windows.
<blockquote>We strongly believe that success for Windows 7 includes an open and honest, and two-way, discussion about how we balance all of these interests and deliver software on the scale of Windows. We promise and will deliver such a dialog with this blog.</blockquote>
I am eagerly looking forward to interesting posts on E7 blog.

<a href="http://blogs.msdn.com/e7/archive/2008/08/14/welcome.aspx"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image29.png" border="0" alt="image" width="557" height="480" /></a>
<div id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:08827010-cb15-4c7b-982a-98cdfd704d9e" class="wlWriterSmartContent" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a rel="tag" href="http://technorati.com/tags/Windows%207">Windows 7</a></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/16/find-duplicates-using-linq/">Find Duplicates Using LINQ</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-16T00:00:00+10:00" pubdate data-updated="true">Aug 16<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content">How can we find duplicate occurrences of values in a collection? I will demonstrate this here using a collection of cities. City class looks like this:

 
<pre class="lang:c# decode:true " >public class City
{
public string Name { get; set; }
public string Country { get; set; }
}</pre> 


Cities collection is initialised with this code:

<pre class="lang:c# decode:true " >
List cities =
new List
{
new City{ Name = "Sydney", Country = "Australia" },
new City{ Name = "Sydney", Country = "Australia" },
new City{ Name = "New York", Country = "USA" },
new City{ Name = "Paris", Country = "France" },
new City{ Name = "Milan", Country = "Spain" },
new City{ Name = "Melbourne", Country = "Australia" },
new City{ Name = "Auckland", Country = "New Zealand" },
new City{ Name = "Tokyo", Country = "Japan" },
new City{ Name = "New Delhi", Country = "India" },
new City{ Name = "Hobart", Country = "Australia" },
new City{ Name = "Boston", Country = "USA"}
};
</pre>

Objective is to find countries which occur more than once in the collection and while I am doing that I would also like to know the number of cities for that country. To do this I can use this query. I am using a foreach loop to output my results.

<pre class="lang:c# decode:true " >
var query =
from c in cities
group c by c.Country into g
where g.Count() &gt; 1
select new { Country = g.Key, CityCount = g.Count()};</pre>
<pre class="lang:c# decode:true " > foreach (var item in query)
{
Console.WriteLine("Country {0} has {1} cities", item.Country, item.CityCount);
}
</pre>

By running the above query I get this output which is correct as there are only two countries in the collection which have more than one city.

<img style="border: 0px;" alt="image" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image28.png" width="279" height="48" border="0" />
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/16/bulk-copy-data-using-sqlbulkcopy-class/">Bulk Copy Data Using SQLBulkCopy Class</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-16T00:00:00+10:00" pubdate data-updated="true">Aug 16<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content">SQLBulkCopy class in ADO.NET can be used to do bulk copy operations from a .Net application. There are two ways data can be bulk copied using this class. You can either do a single bulk copy or a multiple bulk copy operation. In this post I will show you how to perform a single bulk copy operation. I will copy all data in [order details] table from one Northwind database to another. Before running the code I have already cleared the [order details] table in destination database using a truncate statement.

Here is a complete sample which copies data from my Northwind database to Northwind2 database:
<div>
<div style="border-style: none; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;"><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span>[] args)</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">{</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">    <span style="color: #008000;">/******************************************************************</span></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;"><span style="color: #008000;">     * Bulk copy Order Details data from Northwind to Northwind2 database</span></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;"><span style="color: #008000;">     *****************************************************************/</span></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">    <span style="color: #0000ff;">string</span> northwindConnectionString =</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">        <span style="color: #006080;">"Data Source=.;Initial Catalog=Northwind;Integrated Security=True"</span>;</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">    <span style="color: #0000ff;">string</span> northwind2ConnectionString =</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">        <span style="color: #006080;">"Data Source=.;Initial Catalog=Northwind2;Integrated Security=True"</span>;</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">    <span style="color: #0000ff;">using</span> (SqlConnection northwindConnection =</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">        <span style="color: #0000ff;">new</span> SqlConnection(northwindConnectionString))</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">    {</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">        northwindConnection.Open();</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">        SqlCommand command =</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">            <span style="color: #0000ff;">new</span> SqlCommand(<span style="color: #006080;">"Select * from [order details]"</span>, northwindConnection);</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">        SqlDataReader dataReader = command.ExecuteReader();</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">        <span style="color: #0000ff;">using</span> (SqlConnection northwind2Connection =</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">            <span style="color: #0000ff;">new</span> SqlConnection(northwind2ConnectionString))</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">        {</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">            northwind2Connection.Open();</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">            SqlBulkCopy bulkCopy = <span style="color: #0000ff;">new</span> SqlBulkCopy(northwind2Connection);</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">            bulkCopy.DestinationTableName = <span style="color: #006080;">"[Order Details]"</span>;</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">            bulkCopy.WriteToServer(dataReader);</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">            northwind2Connection.Close();</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">        }</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">        northwindConnection.Close();</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">    }</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">    Console.WriteLine(<span style="color: #006080;">"Bulk Copy Operation Successful"</span>);</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">    Console.WriteLine(<span style="color: #006080;">"Press any key to exit..."</span>);</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;"></pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">    Console.ReadKey();</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">}</pre>
</div>
</div>
While executing the above code, I also ran profiler to see the generated statements. SQLBulkCopy produced the following SQL statement for this bulk copy operation.
<div>
<div style="border-style: none; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">insert <span style="color: #0000ff;">bulk</span> [<span style="color: #0000ff;">Order</span> Details] ([OrderID] <span style="color: #0000ff;">Int</span>,</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">[ProductID] <span style="color: #0000ff;">Int</span>,</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">[UnitPrice] Money,</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: #f4f4f4;">[Quantity] <span style="color: #0000ff;">SmallInt</span>,</pre>
<pre style="border-style: none; margin: 0em; padding: 0px; overflow: visible; font-size: 8pt; width: 100%; color: black; line-height: 12pt; font-family: consolas,'Courier New',courier,monospace; background-color: white;">[Discount] <span style="color: #0000ff;">Real</span>)</pre>
</div>
</div>
SQLBulkCopy is a fast efficient way to do bulk copy operations. It is useful when you are handling large amount of data for simple operations such as copying from one location to another.
<div id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:1386bcbe-e058-4a2a-a19e-cfcce06f9e15" class="wlWriterSmartContent" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a rel="tag" href="http://technorati.com/tags/.NET">.NET</a>,<a rel="tag" href="http://technorati.com/tags/ADO.NET">ADO.NET</a></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/14/windows-7-privacy-statement-is-coming-soon/">Windows 7 Privacy Statement Is Coming Soon</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-14T00:00:00+10:00" pubdate data-updated="true">Aug 14<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content">No I am not spreading a rumour. This is as per a <a href="http://www.microsoft.com/windows/windows-7/eula.aspx">Microsoft site</a>.

<a href="http://www.microsoft.com/windows/windows-7/eula.aspx"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image26.png" border="0" alt="image" width="560" height="275" /></a>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/14/different-flavors-of-linq/">Different Flavors of LINQ</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-14T00:00:00+10:00" pubdate data-updated="true">Aug 14<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content">You may have noticed from my blog posts lately that these days I am spending considerable time working with LINQ. Although I mainly concentrate on LINQ To Objects and LINQ To XML, I often wander around and play with other flavors of LINQ as well. Today, just out of curiosity I wanted to see how many flavors of LINQ are out there. And I found many. So here is a list of different LINQ flavors available at present. Some of these are work in progress.
<ol>
	<li><a href="http://msdn.microsoft.com/en-us/library/bb397919.aspx">LINQ To Objects</a></li>
	<li><a href="http://msdn.microsoft.com/en-us/library/bb387098.aspx">LINQ To XML</a></li>
	<li><a href="http://www.debugrelease.com/linq-to-sql-tutorial/">LINQ To SQL</a></li>
	<li><a href="http://www.codeplex.com/LINQFlickr">LINQ To Flickr</a></li>
	<li><a href="http://weblogs.asp.net/fmarguerie/archive/2006/06/26/Introducing-Linq-to-Amazon.aspx">LINQ To Amazon</a></li>
	<li><a href="http://www.codeplex.com/glinq">LINQ To Google</a></li>
	<li><a href="http://community.bartdesmet.net/blogs/bart/archive/2007/04/05/the-iqueryable-tales-linq-to-ldap-part-0.aspx">LINQ To LDAP</a></li>
	<li><a href="http://ayende.com/Blog/archive/2007/03/17/Implementing-Linq-for-NHibernate-A-How-To-Guide--Part.aspx">LINQ To NHibernate</a></li>
</ol>
Am I missing any?
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/13/tutorial-reading-a-text-file-using-linq/">Tutorial Reading a Text File Using LINQ</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-13T00:00:00+10:00" pubdate data-updated="true">Aug 13<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h4>Introduction</h4>
At times us developers have to deal with delimited text files in our applications. Such files have been around since yonks and I often come across data import/export tasks where delimited files are used. Till now the common way in .NET has been to read each line and then extract data using some sort of creative string functions within for loops. But there is another way by using LINQ. In this tutorial I will show you how to use LINQ to read such data. By the end of tutorial you will appreciate how easy and logical it is to use LINQ for reading data from delimited text files.
<h4>Sample Data</h4>
I will use a sample file which contains a data about customers. When working with text files we must know the number of columns and the data contained in each column. Below is a list of columns in their right order for our file.
<ol>
	<li>First Name</li>
	<li>Last Name</li>
	<li>Job Title</li>
	<li>City</li>
	<li>Country</li>
</ol>
The file itself will contain this data. I have pulled this out of Employees table in Northwind database.

<img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image23.png" border="0" alt="image" width="462" height="233" />
<h4>Reading Data</h4>
Before we start reading our csv file we will create a class which will hold a record we will read from our csv file. For this I will create a customer class which looks like this. I know I pulled data from Employees table so just imagine that data above is customer data. Employees can also be customers ;)

 
<pre class="lang:c# decode:true " >public class Customer
{
  string Firstname { get; set; }
  string Lastname { get; set; }
  string JobTitle { get; set; }
  string City { get; set; }
  string Country { get; set; }
}</pre> 


<h5>Reading Entire File</h5>
Now we are ready to read data from our file using LINQ. Using this code we can read the entire file. I am also using a foreach statement to output the results.

 
<pre class="lang:c# decode:true " >var query =
  from line in File.ReadAllLines(filePath)
  let customerRecord = line.Split(',')
  select new Customer()
  {
    Firstname = customerRecord[0],
    Lastname = customerRecord[1],
    JobTitle = customerRecord[2],
    City = customerRecord[3],
    Country = customerRecord[4]
  };

foreach (var item in query)
{
  Console.WriteLine("{0}, {1}, {2}, {3}, {4}",
    item.Firstname, item.Lastname, item.JobTitle, item.City, item.Country);
}</pre> 


File.ReadAllLines() returns an array of lines and we then use the split function of array to split it by a comma. Its just that simple.
<h5>Reading selected records</h5>
We can use this code to read all customers who live in UK.

 
<pre class="lang:c# decode:true " >var query =
  from c in
  (from line in File.ReadAllLines(filePath)
    let customerRecord = line.Split(',')
    select new Customer()
    {
      Firstname = customerRecord[0],
      Lastname = customerRecord[1],
      JobTitle = customerRecord[2],
      City = customerRecord[3],
      Country = customerRecord[4]
    })
    where c.Country == "UK"
    select c;</pre> 


This code can be used to read customers who have sales in their job title.

 
<pre class="lang:c# decode:true " >var query =
        from c in
            (from line in File.ReadAllLines(filePath)
             let customerRecord = line.Split(',')
             select new Customer()
                 {
                     Firstname = customerRecord[0],
                     Lastname = customerRecord[1],
                     JobTitle = customerRecord[2],
                     City = customerRecord[3],
                     Country = customerRecord[4]
                 })
        where c.JobTitle.Contains("Sales")
        select c;</pre> 


I am sure that above queries can be polished by using a bit more syntax sugar but I am just too excited to see LINQ working with a csv file.
<h4>Conclusion</h4>
LINQ makes it extremely simple to work with delimited text files. Once we have the records from a csv file in an object we can use all the power of LINQ to query our hearts out on such files. This functionality is available to us via LINQ to objects and we do not need another flavour of LINQ to achieve this. Stay tuned for more posts on LINQ.
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/13/msdn-library-for-visual-studio-and-net-35-sp1/">MSDN Library for Visual Studio and .NET 3.5 SP1</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-13T00:00:00+10:00" pubdate data-updated="true">Aug 13<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><img style="border-top-width: 0px; border-left-width: 0px; float: left; border-bottom-width: 0px; border-right-width: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image24.png" border="0" alt="image" width="113" height="48" /> While working, you will always find two things running on my machine. One is without any doubt Visual Studio and second is MSDN Library. Since this morning after installing Visual Studio 2008 SP1 I&#8217;ve been trying to get my hands on the latest MSDN Library. Thanks to Iftekhar who <a href="http://iftekharahmedamit.blogspot.com/2008/08/msdn-library-for-visual-studio-2008-sp1.html">pointed</a> me to the latest MSDN Library.

<a href="http://download.microsoft.com/download/1/f/0/1f07c259-7ff2-4902-9205-ad1dfb87ccab/VS2008SP1MSDNENUX1506188.iso">Download link for the latest MSDN Library For Visual Studio SP1</a>. This will download an iso file.
<div id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:6f888a96-27a8-4528-87cb-d1fb48f4e8df" class="wlWriterSmartContent" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a rel="tag" href="http://technorati.com/tags/MSDN">MSDN</a>,<a rel="tag" href="http://technorati.com/tags/Visual%20Studio">Visual Studio</a></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/13/creative-commons-add-in-for-microsoft-office-2007/">Creative Commons Add-in for Microsoft Office 2007</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-13T00:00:00+10:00" pubdate data-updated="true">Aug 13<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" src="https://googledrive.com/host/0B6PDO8HPEQZNZWpTRms0ZWtlaUU/uploads/2008/08/image22.png" border="0" alt="image" width="153" height="51" />

Microsoft provides a <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=d1ddbdc8-627f-415a-9b0a-97362bc9b480&amp;displaylang=en">Creative Commons addin for Microsoft Office 2007</a>. This addin allows authors to embed CC licenses into Excel, Word and PowerPoint. After installing the addin you will see a new tab on the Ribbon.
<div id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:e4a97494-93dd-4618-a69c-8e268c0a4ccc" class="wlWriterSmartContent" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a rel="tag" href="http://technorati.com/tags/Microsoft%20Office">Microsoft Office</a></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/12/net-framework-35-service-pack-1-and-visual-studio-2008-service-pack1-released/">.NET Framework 3.5 Service Pack 1 and Visual Studio 2008 Service Pack1 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-12T00:00:00+10:00" pubdate data-updated="true">Aug 12<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content">Yippeee! SP1 for .Net 3.5 and Visual Studio 2008 has been released. This service pack includes ADO.NET Entity Framework and ADO.NET Data Services. There are WPF designer improvements and WPF performance improvements. You can find more details and download link <a href="http://msdn.microsoft.com/en-us/vsts2008/products/cc533447.aspx">here</a>.

Finally I can now install SQL Server 2008 without disturbing the apple cart :)
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/08/11/exam-70-502-microsoft-net-framework-35-windows-presentation-foundation-study-links-part-2/">Exam 70-502 Microsoft .NET Framework 3.5 Windows Presentation Foundation Study Links – Part 2</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-11T00:00:00+10:00" pubdate data-updated="true">Aug 11<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content">Back in may I posted <a href="http://www.deepakkapoor.net/blog/2008/05/11/exam-70-502-microsoft-net-framework-35-windows-presentation-foundation-study-links-part-1/">Part 1</a> of this series on my <a href="http://www.deepakkapoor.net">old blog</a>. Looking at the statistics it turned out to be one of the highly visited post. Recently I also had a comment asking me when I was publishing other parts of study links. Continuing the same trend here is the second part of this series.
<h3>Building user interfaces</h3>
<h4>Select and configure content controls</h4>
<ol>
	<li><a href="http://msdn.microsoft.com/en-us/library/bb613551.aspx">Controls Overview</a></li>
	<li><a href="http://msdn.microsoft.com/en-us/library/ms754204.aspx">Controls by Category</a></li>
	<li><a href="http://msdn.microsoft.com/en-us/library/system.windows.controls.contentcontrol.aspx">Content Control Class</a> (Also read about all controls that inherit from ContentControl)</li>
</ol>
<h4>Select and configure layout panels</h4>
<ol>
	<li><a href="http://msdn.microsoft.com/en-us/library/ms745058.aspx">The Layout System</a></li>
	<li><a href="http://www.codeproject.com/KB/WPF/GuidedTourWPF_2.aspx">A Guided Tour of WPF - Part 2 (Layout)</a></li>
	<li><a href="http://blogs.msdn.com/shen/archive/2008/01/22/wpf-layout-basics.aspx">WPF Layout Basics</a></li>
	<li><a href="http://blogs.southworks.net/ejadib/2007/12/10/layout-in-windows-presentation-foundation-wpf/">Layout in Windows Presentation Foundation</a></li>
</ol>
<h4>Integrate Windows Forms controls into a WPF application</h4>
<ol>
	<li><a href="http://msdn.microsoft.com/en-gb/library/system.windows.forms.integration.windowsformshost.aspx">WindowsFormsHost Class</a></li>
	<li><a href="http://msdn.microsoft.com/en-gb/library/system.windows.forms.integration.elementhost.aspx">ElementHost Class</a></li>
	<li><a href="http://joshsmithonwpf.wordpress.com/2007/09/05/wpf-vs-windows-forms/">WPF vs. Windows Forms</a> (read this to get an understanding of both sides)</li>
	<li><a href="http://www.devcity.net/Articles/353/1/article.aspx">WinForms and WPF Interop - The Best of Both Worlds</a></li>
	<li><a href="http://msdn.microsoft.com/en-us/library/aa480170.aspx">Walking Through Avalon and Windows Forms Interoperability in Code</a> (This article is a bit old but anything goes for shameless self promotion :))</li>
	<li><a href="http://www.microsoft.com/uk/msdn/nuggets/nugget/277/Windows-Forms-Interop-with-WPF.aspx">Windows Forms Interop with WPF</a> (Screencast)</li>
</ol>
<h4>Create user and custom Controls</h4>
<ol>
	<li><a href="http://www.codeguru.com/cpp/i-n/internet/xml/article.php/c12521/">Creating Custom WPF Controls</a></li>
	<li><a href="http://geekswithblogs.net/thibbard/archive/2008/04/22/wpf-custom-control-dependency-property-gotcha.aspx">WPF Custom Control Dependency Property Gotcha</a></li>
	<li><a href="http://nayyeri.net/blog/how-to-add-commands-to-custom-wpf-control/">How to Add Commands to Custom WPF Control</a></li>
	<li><a href="http://pavanpodila.spaces.live.com/blog/cns!9C9E888164859398!135.entry">Recommended practices for WPF Custom Control developers</a> (old source but still relevant)</li>
	<li><a href="http://www.rooijakkers.net/blog/post/2008/06/WPF.aspx">Initializing controls within your WPF custom control template</a> (good tip)</li>
</ol>
These links should get you started with Building User Interfaces skills requirement for <a href="http://www.microsoft.com/learning/en/us/exams/70-502.mspx">Exam 70-502 TS: Microsoft .NET Framework 3.5 – Windows Presentation Foundation Application Development</a>

<a href="http://www.dotnetkicks.com/kick/?url=http%3a%2f%2fwww.thereforesystems.com%2fexam-70-502-microsoft-net-framework-35-windows-presentation-foundation-study-links-part-2%2f"><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http%3a%2f%2fwww.thereforesystems.com%2fexam-70-502-microsoft-net-framework-35-windows-presentation-foundation-study-links-part-2%2f" border="0" alt="kick it on DotNetKicks.com" /></a>
<div id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:1c6d2f67-3113-4339-9683-5a90351a1fe0" class="wlWriterSmartContent" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a rel="tag" href="http://technorati.com/tags/WPF">WPF</a>,<a rel="tag" href="http://technorati.com/tags/Certification">Certification</a>,<a rel="tag" href="http://technorati.com/tags/70-502">70-502</a></div>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/24/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/22/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/07/31/linux-set-wireless-bit-rate-permanently-on-ubuntu-or-linux-mint/">Linux - Set Wireless Bit Rate Permanently on Ubuntu or Linux Mint</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/31/android-expandablelistview-tutorial/">Android - ExpandableListView Tutorial</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/28/linux-install-handbrake-on-linux-mint-15/">Linux - Install Handbrake on Linux Mint 15</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/26/linux-virtualbox-windows-host-share-in-ubuntu-guest/">Linux VirtualBox - Windows Host Share in Ubuntu Guest</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/25/linux-setgid-on-directory-and-share-directory-with-users/">Linux - Setgid on Directory and Share Directory With Users</a>
      </li>
    
  </ul>
</section>
<div id="fb-root"></div>
<script>(function(d, s, id) {
	  var js, fjs = d.getElementsByTagName(s)[0];
	    if (d.getElementById(id)) return;
	      js = d.createElement(s); js.id = id;
	        js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=295226453878610";
		  fjs.parentNode.insertBefore(js, fjs);
		  }(document, 'script', 'facebook-jssdk'));</script>
	  <div style="text:align:center">
		  <div class="fb-like-box" data-href="https://www.facebook.com/pages/Debug-Release/473369436071930" data-width="250" data-show-faces="true" data-stream="false" data-show-border="true" data-header="false"></div></div>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Deepak Kapoor -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=8878331; 
var sc_invisible=0; 
var sc_security="f0e88835"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="free hit
counters" href="http://statcounter.com/free-hit-counter/"
target="_blank"><img class="statcounter"
src="http://c.statcounter.com/8878331/0/f0e88835/0/"
alt="free hit counters"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://plus.google.com/105555323627924521684?rel=author">Google Profile</a>
<script type='text/javascript'>
    function _dmBootstrap(file) { 
        var _dma = document.createElement('script');  
        _dma.type = 'text/javascript'; 
        _dma.async = true;  
        _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file; 
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined')  _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js');}
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000);})();
</script>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
